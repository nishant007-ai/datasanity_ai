<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Magical Surprise for Suii ‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* ==================================== */
        /* SECTION I: GLOBAL & CINEMATIC STYLES */
        /* ==================================== */

        :root {
            --color-pink: #ff69b4; /* Deep Pink */
            --color-purple: #8a2be2; /* Blue Violet */
            --color-gold: #ffd700; /* Gold */
            --color-green: #00ff88; /* Neon Green */
            --color-blue: #00ccff; /* Sky Blue */
            --bg-dark: #0a0a0a;
            --gradient-magic: linear-gradient(135deg, var(--color-purple), var(--color-pink));
            --font-family: 'Poppins', sans-serif;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: var(--bg-dark);
            color: white;
            height: 100vh;
            width: 100vw;
            display: flex;
            font-family: var(--font-family);
            justify-content: center;
            align-items: center;
            user-select: none;
        }

        .scene-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .scene {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 20px;
            text-align: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 1.5s ease-in-out;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .scene.active {
            opacity: 1;
            pointer-events: auto;
            z-index: 10;
        }

        /* --- Buttons & Global Animations --- */
        .glowing-button {
            background: var(--gradient-magic);
            border: none;
            padding: 15px 30px;
            font-size: 1.5em;
            font-weight: bold;
            color: var(--bg-dark);
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 0 20px var(--color-pink);
            animation: pulse 2s infinite;
            transition: .3s;
            margin: 10px;
        }
        .glowing-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--color-gold);
        }
        .glowing-button:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             animation: none;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 10px var(--color-pink), 0 0 10px var(--color-purple); }
            50% { box-shadow: 0 0 25px var(--color-pink), 0 0 25px var(--color-purple); }
            100% { box-shadow: 0 0 10px var(--color-pink), 0 0 10px var(--color-purple); }
        }
        .mini-btn {
            padding: 10px 20px;
            font-size: 1em;
            border-radius: 20px;
            color: white;
            background: linear-gradient(90deg, var(--color-purple), var(--color-pink));
            box-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }
        .mini-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--color-gold);
        }
        .action-btn {
            background: linear-gradient(90deg, var(--color-blue), var(--color-green));
            color: var(--bg-dark);
            font-weight: bold;
            padding: 12px 25px;
        }

        /* --- Scene Specifics --- */
        #introText {
            font-size: 4em;
            font-weight: 900;
            letter-spacing: 5px;
            text-shadow: 0 0 10px var(--color-pink);
            margin-bottom: 30px;
        }
        input[type="text"] {
            padding: 15px;
            font-size: 1.2em;
            border-radius: 10px;
            border: 2px solid var(--color-purple);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            width: 80%;
            max-width: 400px;
            text-align: center;
            margin: 20px 0;
        }
        #cakeImage {
            animation: rotate3D 5s infinite linear;
            border-radius: 50%;
            box-shadow: 0 0 50px var(--color-pink);
        }
        @keyframes rotate3D {
            0% { transform: rotateY(0deg) scale(1); }
            50% { transform: rotateY(180deg) scale(1.1); }
            100% { transform: rotateY(360deg) scale(1); }
        }

        .reveal-photo {
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            border: 5px solid var(--color-gold);
        }

        /* Heart Shape */
        .neon-heart {
            position: absolute;
            width: 150px;
            height: 150px;
            background-color: transparent;
            border: none;
            box-shadow: 0 0 15px var(--color-pink), 0 0 30px var(--color-purple);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: heartbeat 1.5s infinite;
            z-index: 5;
            clip-path: polygon(50% 0%, 60% 35%, 100% 35%, 100% 70%, 50% 100%, 0% 70%, 0% 35%, 40% 35%);
        }

        @keyframes heartbeat {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
            50% { transform: translate(-50%, -50%) scale(1.15); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
        }

        /* Game Area Style */
        .game-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            margin-bottom: 20px;
            box-shadow: 0 0 15px rgba(255, 105, 180, 0.5);
            backdrop-filter: blur(5px);
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            max-width: 500px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            height: 20px;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--color-pink), var(--color-purple));
            width: 0%;
            transition: width 0.5s;
            border-radius: 10px;
        }

        /* Game Specific Styles */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .memory-card {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--color-purple), var(--color-pink));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.5s;
            perspective: 1000px;
        }
        .memory-card.flipped {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, var(--color-gold), var(--color-green));
        }
        .memory-card.matched {
            background: linear-gradient(135deg, var(--color-green), var(--color-blue));
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--color-green);
        }

        .word-scramble-container {
            margin: 20px 0;
        }
        .scrambled-word {
            font-size: 2em;
            letter-spacing: 10px;
            color: var(--color-gold);
            margin: 20px 0;
            font-weight: bold;
            text-shadow: 0 0 10px var(--color-purple);
        }
        .letter-options {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        .letter-option {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--color-purple), var(--color-pink));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            cursor: grab;
            user-select: none;
        }
        .letter-option.dragging {
            opacity: 0.7;
            transform: scale(1.1);
        }
        .letter-slots {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        .letter-slot {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed var(--color-purple);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
        }
        .letter-slot.filled {
            background: rgba(0, 255, 136, 0.2);
            border: 2px solid var(--color-green);
        }

        .completion-celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
        }
        .completion-celebration.active {
            display: flex;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .celebration-text {
            font-size: 3em;
            color: var(--color-gold);
            text-align: center;
            text-shadow: 0 0 20px var(--color-pink);
            animation: pulse 2s infinite;
            margin-bottom: 30px;
        }

        /* Typewriter cursor */
        .typewriter-cursor {
            display: inline-block;
            width: 3px;
            background-color: var(--color-gold);
            margin-left: 2px;
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* Game Stats */
        .game-stats {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 500px;
            margin-bottom: 20px;
            font-size: 1.1em;
        }
        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
            min-width: 120px;
        }
        .stat-value {
            color: var(--color-gold);
            font-weight: bold;
            font-size: 1.2em;
        }

        /* Achievement Badges */
        .achievement-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--color-gold), var(--color-pink));
            color: var(--bg-dark);
            padding: 5px 10px;
            border-radius: 20px;
            margin: 5px;
            font-size: 0.9em;
            font-weight: bold;
            animation: bounce 1s infinite alternate;
        }
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-5px); }
        }

    </style>
</head>

<body>
    <div class="scene-container">
        <canvas id="magicCanvas"></canvas>
        <audio id="ambient-sound" loop></audio>
        <audio id="celebration-sound"></audio>

        <!-- Completion Celebration Overlay -->
        <div class="completion-celebration" id="completionCelebration">
            <div class="celebration-text">üéâ ALL GAMES COMPLETED! üéâ</div>
            <div style="font-size: 1.5em; color: var(--color-green); margin-bottom: 20px;">
                Perfect Score: <span id="finalScore">0</span> Points!
            </div>
            <div style="margin-bottom: 30px;">
                <div class="achievement-badge">üéØ Master Gamer</div>
                <div class="achievement-badge">üéÇ Birthday Champ</div>
                <div class="achievement-badge">‚ù§Ô∏è Suii's Hero</div>
            </div>
            <button class="glowing-button action-btn" id="continueToFinal">Continue to Final Surprise! üéÅ</button>
        </div>

        <!-- Intro Scene -->
        <div id="introScene" class="scene active">
            <h1 id="introText">A Special Surprise Awaits Suii...</h1>
            <button id="startButton" class="glowing-button">Start Magic ‚ú®</button>
        </div>

        <!-- Quiz Scene -->
        <div id="quizScene" class="scene">
            <div id="quiz-flow" style="width: 100%; max-width: 500px;"></div>
        </div>

        <!-- Cake Reveal Scene -->
        <div id="revealScene" class="scene" style="background: rgba(0,0,0,0.8);">
            <div id="cakeLoader">
               <img id="cakeImage" src="suii_cake.jpg" width="250" height="250" alt="Birthday Cake">
                <p style="font-size:1.5em;color:var(--color-pink);margin-top:30px; font-weight: bold;">
                    Baking Suii's Birthday Cake with Love... üéÇ‚ú®
                </p>
                <div class="progress-container" style="width: 50%; margin-top: 20px;">
                    <div class="progress-bar" id="cakeProgress"></div>
                </div>
            </div>
        </div>

        <!-- Games Scene -->
        <div id="gamesScene" class="scene">
            <h2 style="color: var(--color-gold); text-shadow: 0 0 10px var(--color-gold); margin-bottom: 10px;">
                üéÆ BIRTHDAY GAME ARCADE üéÆ
            </h2>
            <p style="color: var(--color-pink); margin-bottom: 20px;">
                Complete all games to unlock the final surprise!
            </p>
            
            <div class="game-stats">
                <div class="stat-item">
                    <div>üèÜ Score</div>
                    <div class="stat-value" id="totalScore">0</div>
                </div>
                <div class="stat-item">
                    <div>üéØ Games</div>
                    <div class="stat-value" id="gamesCompleted">0/5</div>
                </div>
                <div class="stat-item">
                    <div>‚è±Ô∏è Time</div>
                    <div class="stat-value" id="totalTime">00:00</div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="gameProgress"></div>
            </div>

            <div id="game-area" style="width: 100%; max-width: 600px; margin-top: 20px;"></div>

            <div style="margin-top: 30px; display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
                <button class="mini-btn action-btn" id="hintBtn">üí° Get Hint</button>
                <button class="mini-btn action-btn" id="skipBtn">‚è≠Ô∏è Skip Game</button>
                <button class="mini-btn action-btn" id="restartBtn">üîÑ Restart All</button>
            </div>

            <button id="finish-games-btn" class="glowing-button" style="margin-top:30px; display:none;">
                üéâ Unlock Final Surprise! ‚ù§Ô∏è
            </button>
        </div>

        <!-- Final Scene -->
        <div id="finalScene" class="scene" style="background: radial-gradient(circle, rgba(138, 43, 226, 0.4) 0%, rgba(255, 105, 180, 0.4) 100%);">
            <div id="final-content">
                <div style="display:flex; gap:50px;justify-content:center; position:relative; margin-bottom: 50px;">
                    <img id="nishant-img" src="nishant_photo.jpg" class="reveal-photo" alt="suuii2">
                    <div class="neon-heart"></div>
                    <img id="suhani-img" src="suhani_image.jpg" class="reveal-photo" alt="Suii">
                </div>

                <h1 id="typewriter-line1" style="font-size: 2.5em; color: var(--color-gold);"></h1>
                <h2 id="typewriter-line2" style="font-size: 1.8em; color: white; font-style: italic;"></h2>

                <div id="wishes-container" style="margin-top: 30px;">
                    <p id="current-wish" style="font-size:1.2em; color:var(--color-pink); font-weight: 500; min-height: 50px;"></p>
                    <button id="next-wish-btn" class="glowing-button mini-btn" style="display:none;">Next Wish ‚Üí</button>
                </div>

                <div style="margin-top:30px; display:flex; gap:20px; flex-wrap:wrap; justify-content:center;">
                    <button class="glowing-button mini-btn" id="uploadBtn">üñºÔ∏è Upload Photos</button>
                    <button class="glowing-button mini-btn" id="downloadBtn">‚¨áÔ∏è Download Memory</button>
                    <button class="glowing-button mini-btn" id="whatsapp-share">üì± Share with Suii</button>
                </div>
            </div>
        </div>
    </div>

<script>
/* ================= ENHANCED GAME SYSTEM ================= */

const scenes = {
    intro: document.getElementById('introScene'),
    quiz: document.getElementById('quizScene'),
    reveal: document.getElementById('revealScene'),
    games: document.getElementById('gamesScene'),
    final: document.getElementById('finalScene')
};

// Game State Variables
let currentScene = "intro";
let totalScore = 0;
let gamesPlayed = 0;
let totalGames = 5; // Total number of mini-games
let gameStartTime;
let totalTimeElapsed = 0;
let currentGame = null;
let gameTimer;

// Initialize game system
function initGameSystem() {
    totalScore = 0;
    gamesPlayed = 0;
    gameStartTime = Date.now();
    updateGameStats();
    startTotalTimer();
}

function startTotalTimer() {
    clearInterval(gameTimer);
    gameTimer = setInterval(() => {
        totalTimeElapsed = Math.floor((Date.now() - gameStartTime) / 1000);
        updateGameStats();
    }, 1000);
}

function updateGameStats() {
    document.getElementById('totalScore').textContent = totalScore;
    document.getElementById('gamesCompleted').textContent = `${gamesPlayed}/${totalGames}`;
    
    // Format time as MM:SS
    const minutes = Math.floor(totalTimeElapsed / 60).toString().padStart(2, '0');
    const seconds = (totalTimeElapsed % 60).toString().padStart(2, '0');
    document.getElementById('totalTime').textContent = `${minutes}:${seconds}`;
    
    // Update progress bar
    const progress = (gamesPlayed / totalGames) * 100;
    document.getElementById('gameProgress').style.width = `${progress}%`;
}

/* --- Scene 1: Intro --- */
document.getElementById("startButton").addEventListener("click", () => {
    changeScene("quiz");
    startQuizFlow();
});

function changeScene(id) {
    scenes[currentScene].classList.remove("active");
    currentScene = id;
    scenes[currentScene].classList.add("active");
}

/* --- Scene 2: Quiz Logic --- */
const quizQuestions = [
    { 
        q: "What is your name?", 
        inputId: "q1", 
        correct: "suhani", 
        hint: "It starts with 'S' and rhymes with 'rani'!" 
    },
    { 
        q: "What is your pet name?", 
        inputId: "q2", 
        correct: "suii", 
        hint: "It's the sound of something refreshing and cool!" 
    },
    { 
        q: "When is your birthday? (DD/MM/YYYY)", 
        inputId: "q3", 
        correct: "18", 
        hint: "The unique day of December!" 
    },
    { 
        q: "Who is your best friend?", 
        inputId: "q4", 
        correct: ["Nishant", "Nishu", "Nishant Patil", "Nisha","nisha","nishant"], 
        hint: "He made this surprise for you! üòâ" 
    },
    { 
        q: "What's your favorite color?", 
        inputId: "q5", 
        correct: ["Pink", "Black", "White", "Blue", "Red"], 
        hint: "Think of the colors you wear most often!" 
    }
];

let currentQuizIndex = 0;
const quizFlow = document.getElementById("quiz-flow");

function startQuizFlow() {
    currentQuizIndex = 0;
    displayQuestion();
}

function displayQuestion() {
    if (currentQuizIndex >= quizQuestions.length) {
        endQuiz();
        return;
    }
    
    let q = quizQuestions[currentQuizIndex];
    const correctAnswers = Array.isArray(q.correct) ? q.correct : [q.correct];

    quizFlow.innerHTML = `
        <h2 style="color:var(--color-pink); margin-bottom: 20px;">${q.q}</h2>
        <div style="color: var(--color-gold); font-style: italic; margin-bottom: 10px;">
            ${q.hint || "No hint available"}
        </div>
        <input id="${q.inputId}" type="text" placeholder="Type your answer..." 
               style="width:80%; max-width:300px; margin: 20px 0;">
        <div style="display: flex; gap: 15px; justify-content: center;">
            <button id="next-q-btn" class="glowing-button mini-btn">Submit Answer ‚Üí</button>
            <button id="hint-btn" class="mini-btn" style="background: rgba(255,215,0,0.2);">üí° Hint</button>
        </div>
        <p id="quiz-error" style="color:red; display:none; background:rgba(255,0,0,0.1); 
           padding:10px; border-radius:5px; margin-top: 10px;">
            Not quite right! Try again or click the hint button for help.
        </p>
    `;

    const nextBtn = document.getElementById("next-q-btn");
    const hintBtn = document.getElementById("hint-btn");
    const errorElement = document.getElementById("quiz-error");
    const inputField = document.getElementById(q.inputId);

    nextBtn.onclick = () => {
        let val = inputField.value.trim();
        
        if (correctAnswers.some(x => x.toLowerCase() === val.toLowerCase())) {
            errorElement.style.display = "none";
            nextBtn.disabled = true;
            nextBtn.textContent = 'Correct! üéâ';
            nextBtn.style.background = 'linear-gradient(90deg, #00ff88, #00ccff)';
            
            // Add score
            totalScore += 50;
            updateGameStats();
            
            setTimeout(() => {
                currentQuizIndex++;
                displayQuestion();
            }, 1000);
        } else {
            errorElement.style.display = "block";
            // Vibrate on wrong answer
            if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
        }
    };

    hintBtn.onclick = () => {
        alert(`üí° Hint: ${q.hint}`);
        totalScore -= 10; // Penalty for using hint
        if (totalScore < 0) totalScore = 0;
        updateGameStats();
    };

    inputField.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') nextBtn.click();
    });
    
    inputField.focus();
}

function endQuiz() {
    // Show cake baking animation
    changeScene("reveal");
    
    // Animate cake progress
    const progressBar = document.getElementById('cakeProgress');
    let progress = 0;
    const bakingInterval = setInterval(() => {
        progress += 5;
        progressBar.style.width = `${progress}%`;
        
        if (progress >= 100) {
            clearInterval(bakingInterval);
            setTimeout(() => initMiniGames(), 1000);
        }
    }, 200);
}

/* --- Scene 3: ENHANCED MINI-GAMES --- */

function initMiniGames() {
    changeScene("games");
    initGameSystem();
    gamesPlayed = 0;
    loadNextGame();
}

function loadNextGame() {
    const gameArea = document.getElementById('game-area');
    
    if (gamesPlayed >= totalGames) {
        showCompletionCelebration();
        return;
    }

    // Game sequence with increasing difficulty
    const games = [
        createBirthdayMemoryGame,
        createWordScrambleGame,
        createCakeDecoratingGame,
        createLoveQuizGame,
        createFinalChallengeGame
    ];

    const gameCreator = games[gamesPlayed];
    gameArea.innerHTML = '';
    currentGame = gameCreator();
    gameArea.appendChild(currentGame.container);
    
    // Update UI
    document.getElementById('finish-games-btn').style.display = 'none';
    gamesPlayed++;
    updateGameStats();
}

/* Game 1: Birthday Memory Game */
function createBirthdayMemoryGame() {
    const container = document.createElement('div');
    container.className = 'game-container';
    container.innerHTML = `
        <h3>üéÇ Game ${gamesPlayed + 1}: Birthday Memory Match</h3>
        <p>Match pairs of birthday-themed items!</p>
        <div class="memory-grid" id="memoryGrid"></div>
        <p>Matches: <span id="matchCount">0</span>/6 | Time: <span id="gameTimer">30</span>s</p>
        <p class="result" style="margin-top: 10px;"></p>
    `;

    const symbols = ['üéÇ', 'üéÅ', 'üéà', 'üéâ', '‚ù§Ô∏è', '‚ú®', 'üéÇ', 'üéÅ', 'üéà', 'üéâ', '‚ù§Ô∏è', '‚ú®'];
    let flippedCards = [];
    let matchedPairs = 0;
    let gameTime = 30;
    let canFlip = true;

    // Shuffle symbols
    symbols.sort(() => Math.random() - 0.5);

    const memoryGrid = container.querySelector('#memoryGrid');
    const matchCount = container.querySelector('#matchCount');
    const gameTimerElement = container.querySelector('#gameTimer');
    const resultElement = container.querySelector('.result');

    // Create cards
    symbols.forEach((symbol, index) => {
        const card = document.createElement('div');
        card.className = 'memory-card';
        card.dataset.symbol = symbol;
        card.dataset.index = index;
        
        const cardFront = document.createElement('div');
        cardFront.textContent = '?';
        cardFront.style.cssText = 'width:100%; height:100%; display:flex; align-items:center; justify-content:center;';
        
        card.appendChild(cardFront);
        card.addEventListener('click', () => flipCard(card));
        memoryGrid.appendChild(card);
    });

    function flipCard(card) {
        if (!canFlip || card.classList.contains('flipped') || card.classList.contains('matched')) 
            return;
        
        card.classList.add('flipped');
        card.textContent = card.dataset.symbol;
        flippedCards.push(card);
        
        if (flippedCards.length === 2) {
            canFlip = false;
            const [card1, card2] = flippedCards;
            
            if (card1.dataset.symbol === card2.dataset.symbol) {
                card1.classList.add('matched');
                card2.classList.add('matched');
                matchedPairs++;
                matchCount.textContent = matchedPairs;
                
                // Play match sound effect
                if (matchedPairs === 6) {
                    clearInterval(timer);
                    resultElement.textContent = "Perfect! All matches found! üéâ";
                    resultElement.style.color = "var(--color-green)";
                    
                    totalScore += 100;
                    setTimeout(() => completeGame(), 1500);
                }
                canFlip = true;
            } else {
                setTimeout(() => {
                    card1.classList.remove('flipped');
                    card2.classList.remove('flipped');
                    card1.textContent = '?';
                    card2.textContent = '?';
                    canFlip = true;
                }, 1000);
            }
            flippedCards = [];
        }
    }

    // Game timer
    const timer = setInterval(() => {
        gameTime--;
        gameTimerElement.textContent = gameTime;
        
        if (gameTime <= 0) {
            clearInterval(timer);
            resultElement.textContent = "Time's up! Try again!";
            resultElement.style.color = "red";
            setTimeout(() => loadNextGame(), 2000);
        }
    }, 1000);

    return { container };
}

/* Game 2: Word Scramble - Birthday Theme */
function createWordScrambleGame() {
    const words = [
        { scrambled: "HRAPY", answer: "HAPPY", hint: "Opposite of sad" },
        { scrambled: "YRTBHADI", answer: "BIRTHDAY", hint: "Your special day" },
        { scrambled: "USII", answer: "SUII", hint: "Your pet name" },
        { scrambled: "SHINANT", answer: "NISHANT", hint: "Your best friend" }
    ];
    
    const container = document.createElement('div');
    container.className = 'game-container';
    container.innerHTML = `
        <h3>üéØ Game ${gamesPlayed + 1}: Birthday Word Scramble</h3>
        <p>Unscramble the words to reveal birthday messages!</p>
        <div class="word-scramble-container">
            <div class="scrambled-word" id="scrambledWord"></div>
            <p>Hint: <span id="wordHint"></span></p>
            <div class="letter-slots" id="letterSlots"></div>
            <div class="letter-options" id="letterOptions"></div>
            <p>Words solved: <span id="wordsSolved">0</span>/${words.length}</p>
            <p class="result" style="margin-top: 10px;"></p>
        </div>
    `;

    let currentWordIndex = 0;
    let solvedWords = 0;
    const scrambledWord = container.querySelector('#scrambledWord');
    const wordHint = container.querySelector('#wordHint');
    const letterSlots = container.querySelector('#letterSlots');
    const letterOptions = container.querySelector('#letterOptions');
    const wordsSolved = container.querySelector('#wordsSolved');
    const resultElement = container.querySelector('.result');

    function loadWord() {
        const word = words[currentWordIndex];
        scrambledWord.textContent = word.scrambled.split('').join(' ');
        wordHint.textContent = word.hint;
        
        letterSlots.innerHTML = '';
        letterOptions.innerHTML = '';
        
        // Create letter slots
        for (let i = 0; i < word.answer.length; i++) {
            const slot = document.createElement('div');
            slot.className = 'letter-slot';
            slot.dataset.index = i;
            letterSlots.appendChild(slot);
        }
        
        // Create draggable letters
        const letters = word.scrambled.split('');
        letters.forEach((letter, index) => {
            const option = document.createElement('div');
            option.className = 'letter-option';
            option.textContent = letter;
            option.draggable = true;
            option.dataset.index = index;
            
            option.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', letter);
                option.classList.add('dragging');
            });
            
            option.addEventListener('dragend', () => {
                option.classList.remove('dragging');
            });
            
            letterOptions.appendChild(option);
        });
        
        // Make slots droppable
        const slots = letterSlots.querySelectorAll('.letter-slot');
        slots.forEach(slot => {
            slot.addEventListener('dragover', (e) => e.preventDefault());
            slot.addEventListener('drop', (e) => {
                e.preventDefault();
                const letter = e.dataTransfer.getData('text/plain');
                slot.textContent = letter;
                slot.classList.add('filled');
                checkSolution();
            });
        });
    }

    function checkSolution() {
        const slots = letterSlots.querySelectorAll('.letter-slot');
        const userAnswer = Array.from(slots).map(slot => slot.textContent).join('');
        
        if (userAnswer === words[currentWordIndex].answer) {
            resultElement.textContent = "Correct! üéâ";
            resultElement.style.color = "var(--color-green)";
            solvedWords++;
            wordsSolved.textContent = solvedWords;
            totalScore += 75;
            
            if (solvedWords === words.length) {
                resultElement.textContent += " All words solved! Amazing!";
                setTimeout(() => completeGame(), 1500);
            } else {
                currentWordIndex++;
                setTimeout(() => {
                    resultElement.textContent = '';
                    loadWord();
                }, 1000);
            }
        }
    }

    loadWord();
    return { container };
}

/* Game 3: Cake Decorating Game */
function createCakeDecoratingGame() {
    const container = document.createElement('div');
    container.className = 'game-container';
    container.innerHTML = `
        <h3>üé® Game ${gamesPlayed + 1}: Decorate Suii's Cake</h3>
        <p>Click to add decorations to the birthday cake!</p>
        <div style="position: relative; width: 300px; height: 300px; margin: 20px auto; 
                    background: linear-gradient(135deg, #f9d5e5, #eeac99); border-radius: 50%; 
                    cursor: pointer;" id="cakeCanvas">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
                        color: var(--bg-dark); font-weight: bold;">Click to Decorate!</div>
        </div>
        <p>Decorations: <span id="decoCount">0</span>/20</p>
        <div style="display: flex; gap: 10px; justify-content: center; margin-top: 10px;">
            <button class="mini-btn" id="resetCake">üîÑ Reset</button>
            <button class="mini-btn" id="finishCake">üéâ Finish</button>
        </div>
        <p class="result" style="margin-top: 10px;"></p>
    `;

    const cakeCanvas = container.querySelector('#cakeCanvas');
    const decoCount = container.querySelector('#decoCount');
    const resultElement = container.querySelector('.result');
    let decorationCount = 0;
    const decorations = ['üéÇ', 'üçì', 'üçí', '‚≠ê', '‚ù§Ô∏è', '‚ú®', 'üéÄ', 'üåà', 'üéÅ', 'üéà'];

    cakeCanvas.addEventListener('click', (e) => {
        if (decorationCount >= 20) return;
        
        const rect = cakeCanvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        const deco = document.createElement('div');
        deco.textContent = decorations[Math.floor(Math.random() * decorations.length)];
        deco.style.position = 'absolute';
        deco.style.left = `${x}px`;
        deco.style.top = `${y}px`;
        deco.style.fontSize = '20px';
        deco.style.transform = 'translate(-50%, -50%)';
        deco.style.cursor = 'pointer';
        deco.style.userSelect = 'none';
        
        deco.addEventListener('click', (e) => {
            e.stopPropagation();
            deco.remove();
            decorationCount--;
            decoCount.textContent = decorationCount;
        });
        
        cakeCanvas.appendChild(deco);
        decorationCount++;
        decoCount.textContent = decorationCount;
        
        if (decorationCount >= 20) {
            resultElement.textContent = "Beautiful cake! üéÇ‚ú®";
            resultElement.style.color = "var(--color-pink)";
            totalScore += 125;
        }
    });

    container.querySelector('#resetCake').addEventListener('click', () => {
        cakeCanvas.querySelectorAll('div').forEach(el => {
            if (el !== cakeCanvas.firstElementChild) el.remove();
        });
        decorationCount = 0;
        decoCount.textContent = '0';
        resultElement.textContent = '';
    });

    container.querySelector('#finishCake').addEventListener('click', () => {
        if (decorationCount >= 10) {
            completeGame();
        } else {
            resultElement.textContent = "Add at least 10 decorations!";
            resultElement.style.color = "orange";
        }
    });

    return { container };
}

/* Game 4: Love Quiz Game */
function createLoveQuizGame() {
    const questions = [
        {
            question: "What's the best memory with Suii?",
            options: ["First Meeting", "Long Drives", "Food Adventures", "All of the Above"],
            correct: 3
        },
        {
            question: "What makes Suii smile the most?",
            options: ["Food", "Compliments", "Surprises", "All Three"],
            correct: 3
        },
        {
            question: "What's Suii's superpower?",
            options: ["Making people happy", "Being awesome", "Both", "Neither"],
            correct: 2
        }
    ];

    const container = document.createElement('div');
    container.className = 'game-container';
    let currentQuestion = 0;
    let correctAnswers = 0;

    function loadQuestion() {
        if (currentQuestion >= questions.length) {
            showResults();
            return;
        }

        const q = questions[currentQuestion];
        container.innerHTML = `
            <h3>‚ù§Ô∏è Game ${gamesPlayed + 1}: Know Your Suii Quiz</h3>
            <p>Question ${currentQuestion + 1}/${questions.length}</p>
            <h4 style="color: var(--color-pink); margin: 20px 0;">${q.question}</h4>
            <div id="quizOptions" style="display: flex; flex-direction: column; gap: 10px; margin: 20px 0;">
                ${q.options.map((option, index) => `
                    <button class="mini-btn" data-index="${index}" 
                            style="text-align: left; padding: 15px; font-size: 1.1em;">
                        ${option}
                    </button>
                `).join('')}
            </div>
            <p>Correct: ${correctAnswers}/${currentQuestion}</p>
            <p class="result" style="margin-top: 10px;"></p>
        `;

        const options = container.querySelectorAll('#quizOptions button');
        const resultElement = container.querySelector('.result');

        options.forEach(btn => {
            btn.addEventListener('click', () => {
                const selectedIndex = parseInt(btn.dataset.index);
                
                if (selectedIndex === q.correct) {
                    resultElement.textContent = "Correct! üéâ";
                    resultElement.style.color = "var(--color-green)";
                    btn.style.background = "linear-gradient(90deg, #00ff88, #00ccff)";
                    correctAnswers++;
                    totalScore += 50;
                } else {
                    resultElement.textContent = "Not quite! Try the next one.";
                    resultElement.style.color = "orange";
                    btn.style.background = "rgba(255,0,0,0.3)";
                }
                
                options.forEach(b => b.disabled = true);
                
                setTimeout(() => {
                    currentQuestion++;
                    loadQuestion();
                }, 1500);
            });
        });
    }

    function showResults() {
        container.innerHTML = `
            <h3>‚ù§Ô∏è Quiz Complete!</h3>
            <p style="font-size: 1.2em; margin: 20px 0;">
                You got ${correctAnswers} out of ${questions.length} correct!
            </p>
            <p style="color: var(--color-gold); font-size: 1.5em; margin: 20px 0;">
                ${correctAnswers === questions.length ? 
                  "Perfect! You know Suii perfectly! ‚ù§Ô∏è" : 
                  "Good job! You know Suii well! üòä"}
            </p>
            <button class="glowing-button mini-btn" id="continueQuiz">Continue</button>
        `;
        
        container.querySelector('#continueQuiz').addEventListener('click', completeGame);
        
        // Bonus score for perfect quiz
        if (correctAnswers === questions.length) {
            totalScore += 100;
        }
    }

    loadQuestion();
    return { container };
}

/* Game 5: Final Challenge */
function createFinalChallengeGame() {
    const container = document.createElement('div');
    container.className = 'game-container';
    container.innerHTML = `
        <h3>üèÜ Game ${gamesPlayed + 1}: Final Birthday Challenge</h3>
        <p>Quick! Tap the birthday items before time runs out!</p>
        <div style="position: relative; width: 400px; height: 300px; margin: 20px auto; 
                    background: rgba(255,255,255,0.1); border-radius: 15px; overflow: hidden;" 
             id="tapGameArea">
        </div>
        <div style="display: flex; justify-content: space-between; margin: 10px 0;">
            <div>üéØ Score: <span id="tapScore">0</span></div>
            <div>‚è±Ô∏è Time: <span id="tapTime">30</span>s</div>
            <div>üéØ Target: <span id="tapTarget">20</span></div>
        </div>
        <p class="result" style="margin-top: 10px;"></p>
    `;

    const tapGameArea = container.querySelector('#tapGameArea');
    const tapScore = container.querySelector('#tapScore');
    const tapTime = container.querySelector('#tapTime');
    const tapTarget = container.querySelector('#tapTarget');
    const resultElement = container.querySelector('.result');
    
    let score = 0;
    let timeLeft = 30;
    const target = 20;
    const items = ['üéÇ', 'üéÅ', 'üéà', 'üéâ', '‚ù§Ô∏è', '‚ú®', '‚≠ê', 'üéÄ'];
    let gameActive = true;

    // Game timer
    const gameTimer = setInterval(() => {
        if (!gameActive) return;
        
        timeLeft--;
        tapTime.textContent = timeLeft;
        
        if (timeLeft <= 0) {
            clearInterval(gameTimer);
            gameActive = false;
            endTapGame();
        }
    }, 1000);

    // Create falling items
    function createItem() {
        if (!gameActive) return;
        
        const item = document.createElement('div');
        item.textContent = items[Math.floor(Math.random() * items.length)];
        item.style.position = 'absolute';
        item.style.left = `${Math.random() * 350}px`;
        item.style.top = '-50px';
        item.style.fontSize = '30px';
        item.style.cursor = 'pointer';
        item.style.userSelect = 'none';
        item.style.transition = 'transform 0.2s';
        
        item.addEventListener('click', () => {
            if (!gameActive) return;
            
            score++;
            tapScore.textContent = score;
            item.style.transform = 'scale(1.5)';
            item.style.opacity = '0.5';
            
            // Vibrate on tap
            if (navigator.vibrate) navigator.vibrate(50);
            
            setTimeout(() => item.remove(), 200);
            
            if (score >= target) {
                clearInterval(gameTimer);
                gameActive = false;
                winTapGame();
            }
        });
        
        tapGameArea.appendChild(item);
        
        // Animate falling
        let position = -50;
        const fallInterval = setInterval(() => {
            if (!gameActive) {
                clearInterval(fallInterval);
                return;
            }
            
            position += 2;
            item.style.top = `${position}px`;
            
            if (position > 300) {
                clearInterval(fallInterval);
                item.remove();
            }
        }, 20);
    }

    // Create items periodically
    const itemInterval = setInterval(() => {
        if (!gameActive) {
            clearInterval(itemInterval);
            return;
        }
        createItem();
    }, 500);

    function winTapGame() {
        resultElement.textContent = "AMAZING! You completed all challenges! üéâüèÜ";
        resultElement.style.color = "var(--color-gold)";
        resultElement.style.fontSize = "1.2em";
        totalScore += 200;
        setTimeout(() => completeGame(), 2000);
    }

    function endTapGame() {
        resultElement.textContent = `Time's up! You scored ${score} points.`;
        resultElement.style.color = score >= target ? "var(--color-green)" : "orange";
        
        if (score >= target) {
            winTapGame();
        } else {
            setTimeout(() => loadNextGame(), 3000);
        }
    }

    return { container };
}

/* Game Completion Handler */
function completeGame() {
    updateGameStats();
    
    if (gamesPlayed >= totalGames) {
        showCompletionCelebration();
    } else {
        setTimeout(() => loadNextGame(), 1000);
    }
}

function showCompletionCelebration() {
    clearInterval(gameTimer);
    
    const celebration = document.getElementById('completionCelebration');
    const finalScore = document.getElementById('finalScore');
    
    finalScore.textContent = totalScore;
    celebration.classList.add('active');
    
    // Play celebration sound
    try {
        const audio = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3');
        audio.volume = 0.5;
        audio.play();
    } catch (e) {
        console.log("Celebration sound error:", e);
    }
    
    // Fireworks effect
    for (let i = 0; i < 50; i++) {
        setTimeout(() => {
            createFirework();
        }, i * 100);
    }
}

document.getElementById('continueToFinal').addEventListener('click', () => {
    document.getElementById('completionCelebration').classList.remove('active');
    changeScene('final');
    startFinalReveal();
});

function createFirework() {
    const firework = document.createElement('div');
    firework.style.position = 'fixed';
    firework.style.width = '10px';
    firework.style.height = '10px';
    firework.style.background = ['#ff69b4', '#8a2be2', '#ffd700', '#00ff88'][Math.floor(Math.random() * 4)];
    firework.style.borderRadius = '50%';
    firework.style.left = `${Math.random() * 100}vw`;
    firework.style.top = `${Math.random() * 100}vh`;
    firework.style.boxShadow = '0 0 20px currentColor';
    firework.style.zIndex = '999';
    
    document.body.appendChild(firework);
    
    setTimeout(() => {
        firework.style.transform = `scale(${Math.random() * 3 + 2})`;
        firework.style.opacity = '0';
        setTimeout(() => firework.remove(), 1000);
    }, 100);
}

/* --- Button Event Listeners --- */
document.getElementById('hintBtn').addEventListener('click', () => {
    alert("üí° Hint: Think about what makes Suii happy! Focus on birthday memories.");
    totalScore -= 25;
    if (totalScore < 0) totalScore = 0;
    updateGameStats();
});

document.getElementById('skipBtn').addEventListener('click', () => {
    if (confirm("Skip this game? You'll lose 50 points.")) {
        totalScore = Math.max(0, totalScore - 50);
        loadNextGame();
    }
});

document.getElementById('restartBtn').addEventListener('click', () => {
    if (confirm("Restart all games? Your progress will be lost.")) {
        initMiniGames();
    }
});

document.getElementById('finish-games-btn').addEventListener('click', () => {
    if (gamesPlayed >= totalGames) {
        changeScene('final');
        startFinalReveal();
    } else {
        alert(`Complete all ${totalGames} games first! You've done ${gamesPlayed}/${totalGames}.`);
    }
});

/* --- Scene 5: Final Reveal & Wishes --- */
const birthdayWishes = [
    "Happy Birthday, my Suii! You're the magic in my everyday, the heartbeat in my story, and the most precious chapter in my life. ‚ù§Ô∏è",
    "To my partner, my upcoming depEx partner, and my bestesssssst friend ‚Äì wishing you love, laughter, and endless fun. ‚ú®",
    "Sometimes gadddarrrrrrrr, sometimes angel ‚Äì but always the most amazing Suii ever! üòé",
    "May your day be as cinematic and magical as you make my life feel. You are a masterpiece, Suii. üåü",
    "On your special day, all the glitter, gold, hearts, and laughter rain down on you. Dream big and shine bright! ü•≥",
    "Every moment with you is a celebration. Today, the whole world celebrates YOU! üéâ",
    "To the girl who turned my world into a fairy tale ‚Äì may your birthday be as wonderful as you are! üßö‚Äç‚ôÄÔ∏è"
];

let currentWishIndex = 0;

function typeWriter(element, text, speed, callback) {
    let i = 0;
    element.innerHTML = '';
    function typing() {
        if (i < text.length) {
            element.innerHTML += text.charAt(i) === '\n' ? '<br>' : text.charAt(i);
            i++;
            setTimeout(typing, speed);
        } else if (callback) {
            callback();
        }
    }
    typing();
}

function startFinalReveal() {
    const line1 = document.getElementById('typewriter-line1');
    const line2 = document.getElementById('typewriter-line2');

    typeWriter(line1, "HAPPY BIRTHDAY MY BEST FRIEND SUII! ‚ù§Ô∏è\n\nYou scored " + totalScore + " points in the Birthday Games!", 50, () => {
        setTimeout(() => {
            typeWriter(line2, "From: Nishant  üòé\nWith Love, Fun & Respect Always and you sometimes gaddar suii ,Sih Partner .", 50, () => {
                displayWishes();
            });
        }, 500);
    });
}

function displayWishes() {
    const wishElement = document.getElementById('current-wish');
    const nextBtn = document.getElementById('next-wish-btn');

    currentWishIndex = 0;
    typeWriter(wishElement, birthdayWishes[currentWishIndex], 40);
    nextBtn.style.display = 'inline-block';

    nextBtn.onclick = () => {
        currentWishIndex = (currentWishIndex + 1) % birthdayWishes.length;
        typeWriter(wishElement, birthdayWishes[currentWishIndex], 40);
        nextBtn.textContent = (currentWishIndex === birthdayWishes.length - 1) ? 
            'Back to First Wish' : 'Next Wish ‚Üí';
    };
}

/* --- Final Scene Buttons --- */
document.getElementById('uploadBtn').addEventListener('click', () => {
    alert("Upload feature would open your file browser to add photos!");
});

document.getElementById('downloadBtn').addEventListener('click', () => {
    alert("Downloading your birthday memory poster with score: " + totalScore);
});

document.getElementById('whatsapp-share').addEventListener('click', () => {
    const message = `Check out my birthday surprise from Nishant! I scored ${totalScore} points! üéâ`;
    const url = encodeURIComponent(window.location.href);
    window.open(`https://wa.me/?text=${message}%20${url}`, '_blank');
});

/* --- Initialize Canvas --- */
window.addEventListener('load', () => {
    const canvas = document.getElementById('magicCanvas');
    if (canvas) {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
});
</script>
</body>
</html>